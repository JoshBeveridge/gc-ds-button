<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&display=swap"
  rel="stylesheet"
/>

<!-- Font Awesome (Icons) -->
<link
  href="https://unpkg.com/font-awesome/css/font-awesome.min.css"
  rel="stylesheet"
/>

<style>
  body {
    font-family: var(--gcds-font-families-body);
    font-size: var(--gcds-font-sizes-text);
  }

  /* ----- OVERVIEW PAGE ----- */
  .intro-boxes {
    background-color: var(--gcds-color-grayscale-50);
    margin-block-start: var(--gcds-spacing-450) !important;
    margin-block-end: var(--gcds-spacing-500) !important;
    padding: var(--gcds-spacing-400);
  }

  .intro-boxes li {
    list-style: none;
    background-color: var(--gcds-color-grayscale-0);
    padding: var(--gcds-spacing-400);
  }

  /* ----- PROPERTIES PAGE ----- */

  /* Component Preview - hide React code */
  .sb-show-main #storybook-docs .sb-story > div > *:not(.hydrated) {
    font-size: 0;
    color: var(--gcds-text-light);
    padding: 0 !important;
    border: none !important;
  }

  /* Add space between component preview + copy & hide code btns */
  .docs-story .sb-story {
    padding-block-end: var(--gcds-spacing-500);
  }

  .docs-story .css-25bv1u,
  .css-3s4ai0 .css-111a2cx {
    right: auto !important;
    left: 0 !important;
  }

  .css-3s4ai0 {
    padding-block-end: var(--gcds-spacing-550);
  }

  .css-3s4ai0 .css-111a2cx {
    background-color: transparent !important;
  }

  .docs-story .docblock-code-toggle,
  .css-3s4ai0 .css-otxova {
    border: var(--gcds-button-border-width) solid currentColor !important;
    border-radius: var(--gcds-button-border-radius) !important;
    box-sizing: border-box;
    font: var(--gcds-button-font) !important;
    font-size: 0.875rem !important;
    margin: 0 var(--gcds-spacing-150) var(--gcds-spacing-250)
      var(--gcds-spacing-300) !important;
    padding: var(--gcds-spacing-200) var(--gcds-spacing-150) !important;
    transition: all 0.15s ease-in-out 0s;
  }

  .docs-story .docblock-code-toggle {
    color: var(--gcds-button-secondary-default-text) !important;
  }

  .css-3s4ai0 .css-otxova {
    background-color: #262626 !important;
    color: var(--gcds-text-light) !important;
  }

  .docs-story .docblock-code-toggle:hover:not(:focus) {
    background-color: var(--gcds-button-secondary-hover-background);
    border-color: var(--gcds-button-secondary-default-text);
    color: var(--gcds-button-secondary-default-text);
  }

  .css-3s4ai0 .css-otxova:hover:not(:focus) {
    background-color: rgba(255, 255, 255, 0.2) !important;
  }

  .docs-story .docblock-code-toggle:focus,
  .css-3s4ai0 .css-otxova:focus {
    background-color: var(--gcds-focus-background) !important;
    border-color: var(--gcds-focus-background) !important;
    color: var(--gcds-focus-text) !important;
    outline: var(--gcds-button-shared-focus-outline-width) solid
      var(--gcds-focus-background) !important;
    outline-offset: var(--gcds-button-border-width) !important;
    box-shadow: var(--gcds-button-shared-focus-box-shadow);
  }

  /* Change props table headings */
  .docblock-argstable-head tr th span {
    font-size: 0;
    color: transparent !important;
  }

  .docblock-argstable-head tr th span:before {
    font-size: 0.8125rem;
    color: var(--gcds-text-primary) !important;
  }

  /* Table Styling */
  .docblock-argstable-head tr th,
  .docblock-argstable-body tr td.css-11nj37o,
  .docblock-argstable-body tr .css-11nj37o ~ td,
  .sub-table-heading {
    background-color: var(--gcds-color-grayscale-0) !important;
    border-radius: 0 !important;
    color: var(--gcds-text-primary) !important;
    font-weight: var(--gcds-font-weights-bold);
    padding-block-start: var(--gcds-spacing-400);
    border-inline: 0 !important;
  }

  .css-tm6i3o.css-tm6i3o {
    border-collapse: initial !important;
  }

  .css-quknxc.css-quknxc tbody {
    box-shadow: none !important;
  }

  .css-quknxc.css-quknxc tbody {
    box-shadow: none !important;
    filter: none !important;
  }

  .docblock-argstable-body .css-1oi7qoy td {
    background-color: transparent !important;
    color: var(--gcds-text-primary) !important;
    border: 0 !important;
  }

  .docblock-argstable-body .css-1oi7qoy td:first-of-type {
    padding-block-start: var(--gcds-spacing-450) !important;
  }

  .docblock-argstable-head th:nth-child(1),
  .docblock-argstable-body td:nth-child(1) {
    width: 25% !important;
  }

  .docblock-argstable-head th:nth-child(2),
  .docblock-argstable-body td:nth-child(2) {
    width: 35% !important;
  }

  .docblock-argstable-head th:nth-child(3),
  .docblock-argstable-body td:nth-child(3) {
    width: 35% !important;
  }

  .docblock-argstable-head th:nth-child(4),
  .docblock-argstable-body td:nth-child(4) {
    width: 10% !important;
  }

  /* Style props table as code */
  .docblock-argstable-body tr {
    border: 0 !important;
  }

  .docblock-argstable-body td .css-1jvt1oy,
  .docblock-argstable-body td .css-um6g9i,
  .docblock-argstable-body td .css-1qot2ot,
  .docblock-argstable-body td .css-4q52yj {
    background-color: var(--gcds-color-grayscale-700) !important;
    color: var(--gcds-text-light);
    border: var(--gcds-border-width-sm) solid currentColor;
  }

  .docblock-argstable-body td:not(.sub-table-heading) {
    vertical-align: middle !important;
    background-color: #262626 !important;
    color: var(--gcds-text-light);
    border-bottom: var(--gcds-border-width-sm) solid
      var(--gcds-color-grayscale-700) !important;
  }

  .docblock-argstable-body td span.css-a2cl28 {
    color: var(--gcds-text-light);
  }

  /* Style props form elements */
  .css-16nkwz2,
  .css-je0wjx,
  .css-172ajqq,
  .css-1vhwtr2 {
    font-family: var(--gcds-font-families-body) !important;
  }

  .css-je0wjx {
    font-weight: var(--gcds-font-weights-semibold) !important;
    letter-spacing: 0.75px;
    background-color: transparent !important;
    color: var(--gcds-text-light) !important;
    border: 0 !important;
  }

  .css-tvcum3,
  .css-f2g3hl,
  .css-172ajqq,
  .css-e3ijes,
  .css-1p58akv {
    background-color: var(--gcds-color-grayscale-700) !important;
    border: var(--gcds-border-width-sm) solid var(--gcds-color-grayscale-0) !important;
    padding: var(--gcds-spacing-50) !important;
  }

  .css-tvcum3 span,
  .css-f2g3hl span,
  .css-172ajqq span,
  .css-e3ijes spa,
  .css-130cftl,
  .css-1p58akv {
    color: var(--gcds-text-light) !important;
  }

  .css-6wu5zk svg path {
    fill: var(--gcds-text-light) !important;
  }

  .css-tvcum3 input:checked ~ span:last-of-type,
  .css-tvcum3 input:not(:checked) ~ span:first-of-type,
  .css-f2g3hl input:checked ~ span:last-of-type,
  .css-f2g3hl input:not(:checked) ~ span:first-of-type,
  .css-172ajqq input:checked ~ span:last-of-type,
  .css-172ajqq input:not(:checked) ~ span:first-of-type,
  .css-e3ijes input:checked ~ span:last-of-type,
  .css-e3ijes input:not(:checked) ~ span:first-of-type {
    background: var(--gcds-color-grayscale-0) !important;
    color: var(--gcds-text-primary) !important;
  }

  .css-184lgrq {
    background-color: var(--gcds-color-grayscale-700) !important;
  }

  /* Props table focus styles - form elements */
  .css-6wu5zk:focus-within {
    overflow: visible !important;
  }

  .css-1jvt1oy:focus,
  .css-1qot2ot:focus,
  .css-1p58akv:focus,
  .css-tvcum3:focus-within {
    box-shadow: 0 0 0 var(--gcds-border-width-md) #262626 !important;
    outline-offset: var(--gcds-input-border-width) !important;
    border-color: #262626 !important;
    outline: var(--gcds-input-outline-width) solid var(--gcds-color-grayscale-0) !important;
  }

  .css-tvcum3 input[type='checkbox']:focus {
    box-shadow: none !important;
  }

  /* Props table focus styles - table headings */

  .css-d474as:focus {
    font-size: 0.75rem;
    background-color: var(--gcds-focus-background) !important;
    border-color: var(--gcds-focus-background) !important;
    color: var(--gcds-focus-text) !important;
    border-radius: var(--gcds-button-border-radius) !important;
    outline: var(--gcds-button-shared-focus-outline-width) solid
      var(--gcds-focus-background) !important;
    outline-offset: var(--gcds-button-border-width) !important;
    box-shadow: var(--gcds-button-shared-focus-box-shadow);
  }

  /* Canvas preview */
  .css-ikdg6z {
    background-color: var(--gcds-color-grayscale-50);
  }

  /* Code preview white space */
  .language-html {
    white-space: break-spaces !important;
  }

  .resources-list {
    margin: var(--gcds-spacing-400) 0 !important;
  }

  .resources-list li {
    margin: 0 0 var(--gcds-spacing-300) !important;
  }

  /* ----- COMPONENT SPECIFIC ----- */

  /* gcds-button */
  .sbdocs-preview .docs-story gcds-button.hydrated + gcds-button.hydrated,
  .sb-show-main #storybook-root gcds-button.hydrated + gcds-button.hydrated {
    margin: 0 0 0 var(--gcds-spacing-400);
  }

  /* gcds-container */
  .docs-story .sb-story gcds-container *,
  .sb-show-main #storybook-root gcds-container * {
    margin: var(--gcds-spacing-0);
  }

  /* gcds-icon */
  .sbdocs-preview .docs-story #story--components-icon--name gcds-icon,
  .sbdocs-preview .docs-story #story--components-icon--sizes gcds-icon {
    margin: 0 var(--gcds-spacing-150) 0 0;
  }

  .sbdocs-preview .docs-story #story--components-icon--margin-left gcds-icon,
  .sbdocs-preview .docs-story #story--components-icon--margin-right gcds-icon {
    display: block;
  }

  .sbdocs-preview .docs-story #story--components-icon--margin-right-inner {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
  }

  .sbdocs-preview .docs-story #story--components-icon--width gcds-icon {
    margin: 0 var(--gcds-spacing-150) 0 0;
    border: var(--gcds-border-width-sm) solid var(--gcds-border-default);
  }

  /* gcds-link */
  .sbdocs-preview .docs-story #story--components-link--variant-light {
    background: var(--gcds-color-grayscale-900);
    padding: var(--gcds-spacing-450);
  }

  /* gcds-signature */
  .sbdocs-preview .docs-story #story--components-signature--signature-white,
  .sbdocs-preview .docs-story #story--components-signature--wordmark-white {
    background: var(--gcds-color-grayscale-900);
    padding: var(--gcds-spacing-450);
  }

  /* gcds-text */
  .sbdocs-preview .docs-story #story--components-text--light {
    background: var(--gcds-color-grayscale-900);
    padding: var(--gcds-spacing-450);
  }

  /* gcds-top-nav */
  #story--components-top-navigation--default {
    height: 300px;
  }

  .css-8ycahn * .token.comment {
      color: white !important;
  }
</style>

<script>
  const url = new URLSearchParams(window.location.search);

  if (url.get('demo') && url.get('lang')) {
    var tableTimer = setInterval(function() {
      if (document.querySelector('.docblock-argstable')) {
        clearInterval(tableTimer);
	      formatTable(document.querySelector('.docblock-argstable'), url.get('lang'));
      }
    }, 200);

    // Change language on hide/copy code buttons
    if (url.get('lang') === 'fr') {
      var buttonTimer = setInterval(function() {
        if (document.querySelector('.docblock-code-toggle')) {
          clearInterval(buttonTimer);
          formatFrenchButtons(document.querySelector('.docblock-code-toggle'));
        }
      }, 200);

      copyButtonTimer();
    }
  }

  let observer = new MutationObserver((mutation) => {
    if (mutation[0].target.parentElement.innerText === 'Copied') {
      mutation[0].target.parentElement.innerText = 'Copié'
    } else if (mutation[0].target.parentNode.innerText === 'Copy') {
      mutation[0].target.parentElement.innerText = 'Copie'
    }
  });

  function copyButtonTimer() {
    var buttonTimer = setInterval(function() {
      if (document.querySelector('.css-otxova')) {
        document.querySelector('.css-otxova').innerText = 'Copie';
        clearInterval(buttonTimer);
        observer.observe(document.querySelector('.css-111a2cx'), { characterData: true, attributes: false, childList: false, subtree: true });
      }
    }, 200);
  }

  function formatFrenchButtons(button) {
    setTimeout(() => {
      button.innerText = "Masquer le code";
    }, 10);
    button.addEventListener('click', () => {
      if (!button.classList.contains('docblock-code-toggle--expanded')) {
        setTimeout(() => {
          button.innerText = "Masquer le code";
        }, 10);
        copyButtonTimer();
      } else {
        setTimeout(() => {
          button.innerText = "Voir le code";
        }, 10);
      }
    });
  }

  function formatTable(table, lang) {
    // Format table header
    const tableHead = [...table.querySelectorAll('th')];
    tableHead.forEach(th => {
      th.setAttribute('lang', lang);
      if (lang == 'en') {
        const thText = th.innerText;
        if (thText == 'Name') {
          th.innerText = 'Property';
        } else if (thText == 'Description') {
          th.innerText = 'Data type';
        } else if (thText == 'Default') {
          th.innerText = 'Default value';
        } else if (thText == 'Control') {
          const resetBtn = th.querySelector('button');
          th.innerText = 'Values';
          resetBtn.setAttribute('style', 'float: right;');
          th.append(resetBtn);
        }
      } else {
        const thText = th.innerText;
        if (thText == 'Name') {
          th.innerText = 'Propriété';
        } else if (thText == 'Description') {
          th.innerText = 'Type de donnée';
        } else if (thText == 'Default') {
          th.innerText = 'Valeur par défaut';
        } else if (thText == 'Control') {
          const resetBtn = th.querySelector('button');
          th.innerText = 'Valeurs';
          resetBtn.setAttribute('style', 'float: right;');
          resetBtn.setAttribute('title', 'Réinitialiser les contrôles');
          th.append(resetBtn);
        }
      }
    });

    // Table Rows
    const tableRows = [...table.querySelectorAll('tbody > tr')];
    tableRows.forEach(tr => {
      // Expand collapse rows
      if (tr.hasAttribute('class')) {
        tr.removeAttribute('title');
        const cellText = tr.children[0].children[1].innerText.toLowerCase().split(' | ');
        tr.children[1].innerText = lang === 'en' ? 
          cellText[0].charAt(0).toUpperCase() + cellText[0].slice(1) : 
          cellText[1].replace(' items', '').charAt(0).toUpperCase() + cellText[1].slice(1);
        tr.setAttribute('class', '');
        tr.children[1].setAttribute('colspan', '4');
        tr.children[1].setAttribute('class', 'sub-table-heading');
        tr.removeChild(tr.children[0]);
      }

      // Loop through table cells
      const propertyId = `${tr.children[0].innerText.replace('*', '')}-property`;
      for (let x = 0; x < tr.children.length; x++) {
        // Format first cell
        if (x == 0) {
          tr.children[x].setAttribute('id', propertyId);
          if (tr.children[x].querySelector('[title=Required]') && lang == 'fr') {
            tr.children[x].querySelector('[title=Required]').setAttribute('lang', 'fr');
            tr.children[x].querySelector('[title=Required]').setAttribute('title', 'Obligatoire');
          }
        }
        // Format third cell
        if (tr.children[x].innerText === '-') {
          let span = document.createElement('span');
          span.setAttribute('class', 'sr-only');

          if (lang === 'en') {
            tr.children[x].setAttribute('title', 'No default value');
            span.innerText = 'No default value';
            tr.children[x].append(span);
          } else {
            tr.children[x].setAttribute('title', 'Aucune valeur par défaut');
            tr.children[x].setAttribute('lang', 'fr');
            span.innerText = 'Aucune valeur par défaut';
            tr.children[x].append(span);
          }
        }
        // Format last cell
        if (x === 3) {
          if (tr.children[x].querySelector('select')) {
            tr.children[x].querySelector('select').setAttribute('aria-labelledby', propertyId);

            if (lang === 'fr') {
              const firstSelectOption = tr.children[x].querySelector('select').children[0];
              firstSelectOption.setAttribute('lang', 'fr');
              firstSelectOption.innerText = 'Choisir une option';
            }
          }

          // Remove placeholders and assign aria-labelledby
          if (tr.children[x].querySelector('[placeholder]')) {
            const formElement = tr.children[x].querySelector('[placeholder]');
            formElement.removeAttribute('placeholder');
            formElement.setAttribute('aria-labelledby', propertyId);
          }
        }
      }
    });
  }
</script>